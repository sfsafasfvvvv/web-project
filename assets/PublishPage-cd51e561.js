import{_ as oe,u as se,L as ie,r as f,c as re,a as n,b as p,d as b,e as t,i as l,g as a,N as ne,m as c,a3 as ue,k as r,f as w,j as P,F as z,h as F,t as m,a2 as de,a4 as V,a5 as pe,a6 as me,E as g}from"./index-237fd1da.js";const ce={class:"publish-page"},ge={class:"container"},ve={class:"publish-container"},fe={class:"publish-main"},be={class:"upload-placeholder",style:{background:"#f5f5f5"}},_e={class:"publish-side"},ye={class:"tips-card"},we={class:"tips-list"},Pe={class:"contact-card"},Ve={class:"preview-content"},he={class:"preview-header"},xe={class:"preview-price"},ke={class:"current-price"},Ce={key:0,class:"original-price"},Me={class:"preview-info"},Te={class:"info-item"},qe={class:"info-item"},Se={class:"info-item"},Le={key:0,class:"info-item"},Ue={class:"preview-description"},Ne={key:0,class:"preview-tags"},Ie={class:"tags-list"},Be={__name:"PublishPage",setup(ze){const G=se();ie();const h=f(null),o=f({images:[],title:"",category:[],price:"",originalPrice:"",condition:"",tradeMethods:[],location:[],description:"",tags:[]}),R={images:[{required:!0,message:"Please upload at least one image",trigger:"change"}],title:[{required:!0,message:"Please enter product title",trigger:"blur"},{min:2,max:30,message:"Length should be 2 to 30 characters",trigger:"blur"}],category:[{required:!0,message:"Please select product category",trigger:"change"}],price:[{required:!0,message:"Please enter selling price",trigger:"blur"},{type:"number",min:0,message:"Price must be greater than 0",trigger:"blur"}],condition:[{required:!0,message:"Please select product condition",trigger:"change"}],tradeMethods:[{required:!0,message:"Please select at least one trading method",trigger:"change"},{type:"array",min:1,message:"Please select at least one trading method",trigger:"change"}],location:[{required:!0,message:"Please select trading location",trigger:"change"}],description:[{required:!0,message:"Please enter product description",trigger:"blur"},{min:10,max:1e3,message:"Length should be 10 to 1000 characters",trigger:"blur"}]},D=[{value:"books",label:"Books",children:[{value:"textbook",label:"Textbooks"},{value:"reference",label:"Study Materials"},{value:"literature",label:"Literature"}]},{value:"electronics",label:"Electronics",children:[{value:"phone",label:"Phones"},{value:"computer",label:"Computers"},{value:"accessories",label:"Accessories"}]},{value:"daily",label:"Daily Necessities",children:[{value:"clothing",label:"Clothing"},{value:"cosmetics",label:"Cosmetics"},{value:"food",label:"Food"}]},{value:"sports",label:"Sports & Fitness",children:[{value:"equipment",label:"Equipment"},{value:"clothing",label:"Sportswear"},{value:"shoes",label:"Sports Shoes"}]}],E=[{value:"campus1",label:"Main Campus",children:[{value:"library",label:"Library"},{value:"student_center",label:"Student Center"},{value:"cafeteria",label:"Cafeteria"}]},{value:"campus2",label:"Secondary Campus",children:[{value:"dorm",label:"Dormitory"},{value:"gym",label:"Gymnasium"},{value:"classroom",label:"Classroom Building"}]}],x=f(!1),v=f(""),T=f(null),k=f(!1),q=re(()=>o.value.tradeMethods.includes("face")||o.value.tradeMethods.includes("pickup")),$=async()=>{if(h.value)try{await h.value.validate(),k.value=!0,await new Promise(s=>setTimeout(s,1e3)),g.success("Product posted successfully"),G.push("/user/published")}catch(s){console.error("Failed to submit:",s),g.error("Failed to post product")}finally{k.value=!1}},j=()=>{g.info("Preview feature coming soon")},A=s=>{},H=s=>{},K=s=>{const e=s.type.startsWith("image/"),d=s.size/1024/1024<2;return e?d?!0:(g.error("Image size cannot exceed 2MB"),!1):(g.error("Only image files are allowed"),!1)},O=()=>{x.value=!0,nextTick(()=>{var s,e;(e=(s=T.value)==null?void 0:s.input)==null||e.focus()})},S=()=>{if(v.value){if(o.value.tags.length>=5){g.warning("Maximum 5 tags allowed");return}if(v.value.length>10){g.warning("Tag length cannot exceed 10 characters");return}o.value.tags.push(v.value)}x.value=!1,v.value=""},J=s=>{o.value.tags=o.value.tags.filter(e=>e!==s)},W=s=>s!=null&&s.length?s.join(" > "):"",Q=s=>({100:"Brand New",95:"Like New",90:"Very Good",80:"Good",70:"Acceptable"})[s]||"",X=s=>{if(!(s!=null&&s.length))return"";const e={face:"Meet on Campus",pickup:"Campus Pickup Point",express:"Shipping"};return s.map(d=>e[d]).join(", ")},Y=s=>s!=null&&s.length?s.join(" > "):"";return(s,e)=>{const d=n("el-icon"),Z=n("el-upload"),u=n("el-form-item"),C=n("el-input"),L=n("el-cascader"),U=n("el-input-number"),N=n("el-col"),ee=n("el-row"),_=n("el-radio-button"),le=n("el-radio-group"),M=n("el-checkbox"),te=n("el-checkbox-group"),I=n("el-tag"),y=n("el-button"),ae=n("el-form"),B=n("el-dialog");return p(),b("div",ce,[t("div",ge,[t("div",ve,[t("div",fe,[e[27]||(e[27]=t("h2",{class:"page-title"},"Post Item",-1)),e[28]||(e[28]=t("p",{class:"page-subtitle"},"Fill in the item details to let more students discover your product",-1)),l(ae,{ref_key:"formRef",ref:h,model:o.value,rules:R,"label-width":"120px",class:"publish-form",onSubmit:ne($,["prevent"])},{default:a(()=>[l(u,{label:"Images",prop:"images",required:""},{default:a(()=>[l(Z,{"file-list":o.value.images,"onUpdate:fileList":e[0]||(e[0]=i=>o.value.images=i),action:"/api/upload","list-type":"picture-card",limit:9,"on-preview":A,"on-remove":H,"before-upload":K},{tip:a(()=>e[12]||(e[12]=[t("div",{class:"upload-tip"}," Supports JPG and PNG formats, up to 9 images, max 2MB each ",-1)])),default:a(()=>[t("div",be,[l(d,null,{default:a(()=>[l(c(ue))]),_:1})])]),_:1},8,["file-list"])]),_:1}),l(u,{label:"Title",prop:"title",required:""},{default:a(()=>[l(C,{modelValue:o.value.title,"onUpdate:modelValue":e[1]||(e[1]=i=>o.value.title=i),placeholder:"Enter product title (2-30 characters)",maxlength:"30","show-word-limit":""},null,8,["modelValue"])]),_:1}),l(u,{label:"Category",prop:"category",required:""},{default:a(()=>[l(L,{modelValue:o.value.category,"onUpdate:modelValue":e[2]||(e[2]=i=>o.value.category=i),options:D,props:{expandTrigger:"hover",value:"value",label:"label"},placeholder:"Select product category",clearable:""},null,8,["modelValue"])]),_:1}),l(u,{label:"Price",required:""},{default:a(()=>[l(ee,{gutter:20},{default:a(()=>[l(N,{span:12},{default:a(()=>[l(u,{prop:"price"},{default:a(()=>[l(U,{modelValue:o.value.price,"onUpdate:modelValue":e[3]||(e[3]=i=>o.value.price=i),min:0,precision:2,step:.01,placeholder:"Selling price"},{prefix:a(()=>e[13]||(e[13]=[r("$")])),_:1},8,["modelValue"])]),_:1})]),_:1}),l(N,{span:12},{default:a(()=>[l(u,{prop:"originalPrice"},{default:a(()=>[l(U,{modelValue:o.value.originalPrice,"onUpdate:modelValue":e[4]||(e[4]=i=>o.value.originalPrice=i),min:0,precision:2,step:.01,placeholder:"Original price (optional)"},{prefix:a(()=>e[14]||(e[14]=[r("$")])),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),l(u,{label:"Condition",prop:"condition",required:""},{default:a(()=>[l(le,{modelValue:o.value.condition,"onUpdate:modelValue":e[5]||(e[5]=i=>o.value.condition=i)},{default:a(()=>[l(_,{label:"100"},{default:a(()=>e[15]||(e[15]=[r("Brand New")])),_:1}),l(_,{label:"95"},{default:a(()=>e[16]||(e[16]=[r("Like New")])),_:1}),l(_,{label:"90"},{default:a(()=>e[17]||(e[17]=[r("Very Good")])),_:1}),l(_,{label:"80"},{default:a(()=>e[18]||(e[18]=[r("Good")])),_:1}),l(_,{label:"70"},{default:a(()=>e[19]||(e[19]=[r("Acceptable")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(u,{label:"Trading Method",prop:"tradeMethods",required:""},{default:a(()=>[l(te,{modelValue:o.value.tradeMethods,"onUpdate:modelValue":e[6]||(e[6]=i=>o.value.tradeMethods=i)},{default:a(()=>[l(M,{label:"face"},{default:a(()=>e[20]||(e[20]=[r("Meet on Campus")])),_:1}),l(M,{label:"pickup"},{default:a(()=>e[21]||(e[21]=[r("Campus Pickup Point")])),_:1}),l(M,{label:"express"},{default:a(()=>e[22]||(e[22]=[r("Shipping")])),_:1})]),_:1},8,["modelValue"])]),_:1}),q.value?(p(),w(u,{key:0,label:"Location",prop:"location",required:""},{default:a(()=>[l(L,{modelValue:o.value.location,"onUpdate:modelValue":e[7]||(e[7]=i=>o.value.location=i),options:E,props:{expandTrigger:"hover",value:"value",label:"label"},placeholder:"Select trading location",clearable:""},null,8,["modelValue"])]),_:1})):P("",!0),l(u,{label:"Description",prop:"description",required:""},{default:a(()=>[l(C,{modelValue:o.value.description,"onUpdate:modelValue":e[8]||(e[8]=i=>o.value.description=i),type:"textarea",rows:6,placeholder:"Please describe the condition, usage experience, purchase source, etc. (10-1000 characters)",maxlength:"1000","show-word-limit":""},null,8,["modelValue"])]),_:1}),l(u,{label:"Tags",prop:"tags"},{default:a(()=>[(p(!0),b(z,null,F(o.value.tags,i=>(p(),w(I,{key:i,closable:"","disable-transitions":!1,onClose:Fe=>J(i)},{default:a(()=>[r(m(i),1)]),_:2},1032,["onClose"]))),128)),x.value?(p(),w(C,{key:0,ref_key:"InputRef",ref:T,modelValue:v.value,"onUpdate:modelValue":e[9]||(e[9]=i=>v.value=i),class:"tag-input",size:"small",onKeyup:de(S,["enter"]),onBlur:S},null,8,["modelValue"])):(p(),w(y,{key:1,class:"button-new-tag",size:"small",onClick:O},{default:a(()=>e[23]||(e[23]=[r(" + Add Tag ")])),_:1})),e[24]||(e[24]=t("div",{class:"form-tip"}," Maximum 5 tags, each tag up to 10 characters ",-1))]),_:1}),l(u,null,{default:a(()=>[l(y,{type:"primary","native-type":"submit",loading:k.value,size:"large"},{default:a(()=>e[25]||(e[25]=[r(" Post Item ")])),_:1},8,["loading"]),l(y,{size:"large",onClick:j},{default:a(()=>e[26]||(e[26]=[r(" Preview ")])),_:1})]),_:1})]),_:1},8,["model"])]),t("div",_e,[t("div",ye,[e[33]||(e[33]=t("h3",null,"Posting Tips",-1)),t("ul",we,[t("li",null,[l(d,null,{default:a(()=>[l(c(V))]),_:1}),e[29]||(e[29]=t("span",null,"Product images should be real and clear",-1))]),t("li",null,[l(d,null,{default:a(()=>[l(c(V))]),_:1}),e[30]||(e[30]=t("span",null,"Title should be concise, description should be detailed",-1))]),t("li",null,[l(d,null,{default:a(()=>[l(c(V))]),_:1}),e[31]||(e[31]=t("span",null,"Price should be reasonable, no fake original prices",-1))]),t("li",null,[l(d,null,{default:a(()=>[l(c(V))]),_:1}),e[32]||(e[32]=t("span",null,"No prohibited items or false information",-1))])])]),t("div",Pe,[e[36]||(e[36]=t("h3",null,"Need Help?",-1)),e[37]||(e[37]=t("p",null,"If you encounter any issues while posting, you can:",-1)),l(y,{type:"primary",text:""},{default:a(()=>[l(d,null,{default:a(()=>[l(c(pe))]),_:1}),e[34]||(e[34]=r(" Contact Support "))]),_:1}),l(y,{type:"primary",text:""},{default:a(()=>[l(d,null,{default:a(()=>[l(c(me))]),_:1}),e[35]||(e[35]=r(" View Help "))]),_:1})])])])]),l(B,{modelValue:s.previewVisible,"onUpdate:modelValue":e[10]||(e[10]=i=>s.previewVisible=i),title:"Image Preview"},{default:a(()=>e[38]||(e[38]=[t("div",{class:"preview-image",style:{background:"#f5f5f5",width:"100%",height:"400px",borderRadius:"12px"}},null,-1)])),_:1},8,["modelValue"]),l(B,{modelValue:s.productPreviewVisible,"onUpdate:modelValue":e[11]||(e[11]=i=>s.productPreviewVisible=i),title:"Product Preview",width:"800px",class:"preview-dialog"},{default:a(()=>[t("div",Ve,[t("div",he,[t("h2",null,m(o.value.title),1),t("div",xe,[t("span",ke,"$"+m(o.value.price),1),o.value.originalPrice?(p(),b("span",Ce," $"+m(o.value.originalPrice),1)):P("",!0)])]),t("div",Me,[t("div",Te,[e[39]||(e[39]=t("label",null,"Category:",-1)),t("span",null,m(W(o.value.category)),1)]),t("div",qe,[e[40]||(e[40]=t("label",null,"Condition:",-1)),t("span",null,m(Q(o.value.condition)),1)]),t("div",Se,[e[41]||(e[41]=t("label",null,"Trading Method:",-1)),t("span",null,m(X(o.value.tradeMethods)),1)]),q.value?(p(),b("div",Le,[e[42]||(e[42]=t("label",null,"Location:",-1)),t("span",null,m(Y(o.value.location)),1)])):P("",!0)]),t("div",Ue,[e[43]||(e[43]=t("h3",null,"Description",-1)),t("p",null,m(o.value.description),1)]),o.value.tags.length?(p(),b("div",Ne,[e[44]||(e[44]=t("h3",null,"Tags",-1)),t("div",Ie,[(p(!0),b(z,null,F(o.value.tags,i=>(p(),w(I,{key:i,size:"small"},{default:a(()=>[r(m(i),1)]),_:2},1024))),128))])])):P("",!0)])]),_:1},8,["modelValue"])])}}},Re=oe(Be,[["__scopeId","data-v-fdc98333"]]);export{Re as default};
