import{_ as B,u as D,L as J,r as g,M as G,a as n,b as V,d as x,e as o,i as l,g as t,N as L,m as d,P as k,Q as W,k as p,t as $,R as Q,S as U,F as Z,h as H,D as K,T as O,E as v}from"./index-237fd1da.js";const X={class:"register-page"},Y={class:"auth-container"},ee={class:"auth-card"},le={class:"auth-footer"},oe={class:"auth-banner"},ae={class:"banner-content"},se={class:"feature-list"},re={__name:"RegisterPage",setup(te){const S=D(),C=J(),f=g(null),c=g(!1),m=g(0),y=g(!1),_=g(!1),a=G({username:"",phone:"",code:"",password:"",confirmPassword:"",school:"",agreement:!1}),R=[{value:"pku",label:"Peking University"},{value:"thu",label:"Tsinghua University"},{value:"fudan",label:"Fudan University"},{value:"sjtu",label:"Shanghai Jiao Tong University"},{value:"zju",label:"Zhejiang University"}],E={username:[{required:!0,message:"Please enter your username",trigger:"blur"},{min:3,message:"Username must be at least 3 characters",trigger:"blur"}],phone:[{required:!0,validator:(i,e,s)=>{e===""?s(new Error("Please enter your phone number")):/^1[3-9]\d{9}$/.test(e)?s():s(new Error("Please enter a valid phone number"))},trigger:"blur"}],code:[{required:!0,message:"Please enter verification code",trigger:"blur"},{len:6,message:"Verification code must be 6 digits",trigger:"blur"}],password:[{required:!0,validator:(i,e,s)=>{var u;e===""?s(new Error("Please enter your password")):(a.confirmPassword!==""&&((u=f.value)==null||u.validateField("confirmPassword")),s())},trigger:"blur"},{min:6,message:"Password must be at least 6 characters",trigger:"blur"}],confirmPassword:[{required:!0,validator:(i,e,s)=>{e===""?s(new Error("Please confirm your password")):e!==a.password?s(new Error("Passwords do not match")):s()},trigger:"blur"}],school:[{required:!0,message:"Please select your school",trigger:"change"}],agreement:[{validator:(i,e,s)=>{e?s():s(new Error("Please agree to the Terms of Service and Privacy Policy"))},trigger:"change"}]},F=async()=>{var i;try{await((i=f.value)==null?void 0:i.validateField("phone")),c.value=!0,await new Promise(s=>setTimeout(s,1e3)),v.success("Verification code sent successfully"),m.value=60;const e=setInterval(()=>{m.value--,m.value<=0&&clearInterval(e)},1e3)}catch(e){console.error("Failed to send code:",e),v.error(e.message||"Failed to send verification code")}finally{c.value=!1}},T=async()=>{if(f.value)try{await f.value.validate(),c.value=!0,await C.register({username:a.username,phone:a.phone,code:a.code,password:a.password,school:a.school}),v.success("Registration successful"),S.push("/login")}catch(i){console.error("Failed to register:",i),v.error(i.message||"Registration failed, please try again")}finally{c.value=!1}},z=()=>{y.value=!0},q=()=>{_.value=!0};return(i,e)=>{const s=n("el-input"),u=n("el-form-item"),P=n("el-button"),M=n("el-option"),I=n("el-select"),h=n("el-link"),j=n("el-checkbox"),N=n("router-link"),A=n("el-form"),w=n("el-icon"),b=n("el-dialog");return V(),x("div",X,[o("div",Y,[o("div",ee,[e[16]||(e[16]=o("div",{class:"auth-header"},[o("h2",null,"Create Account"),o("p",null,"Join the campus marketplace and start your trading journey")],-1)),l(A,{ref_key:"formRef",ref:f,model:a,rules:E,class:"auth-form",onSubmit:L(T,["prevent"])},{default:t(()=>[l(u,{prop:"username"},{default:t(()=>[l(s,{modelValue:a.username,"onUpdate:modelValue":e[0]||(e[0]=r=>a.username=r),placeholder:"Username","prefix-icon":d(k),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1}),l(u,{prop:"phone"},{default:t(()=>[l(s,{modelValue:a.phone,"onUpdate:modelValue":e[1]||(e[1]=r=>a.phone=r),placeholder:"Phone number","prefix-icon":d(W),size:"large"},{append:t(()=>[l(P,{disabled:!!m.value||!a.phone,onClick:F},{default:t(()=>[p($(m.value?`${m.value}s`:"Get Code"),1)]),_:1},8,["disabled"])]),_:1},8,["modelValue","prefix-icon"])]),_:1}),l(u,{prop:"code"},{default:t(()=>[l(s,{modelValue:a.code,"onUpdate:modelValue":e[2]||(e[2]=r=>a.code=r),placeholder:"Verification code","prefix-icon":d(Q),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1}),l(u,{prop:"password"},{default:t(()=>[l(s,{modelValue:a.password,"onUpdate:modelValue":e[3]||(e[3]=r=>a.password=r),type:"password",placeholder:"Password","prefix-icon":d(U),size:"large","show-password":""},null,8,["modelValue","prefix-icon"])]),_:1}),l(u,{prop:"confirmPassword"},{default:t(()=>[l(s,{modelValue:a.confirmPassword,"onUpdate:modelValue":e[4]||(e[4]=r=>a.confirmPassword=r),type:"password",placeholder:"Confirm password","prefix-icon":d(U),size:"large","show-password":""},null,8,["modelValue","prefix-icon"])]),_:1}),l(u,{prop:"school"},{default:t(()=>[l(I,{modelValue:a.school,"onUpdate:modelValue":e[5]||(e[5]=r=>a.school=r),placeholder:"Select school",size:"large",class:"school-select",filterable:""},{default:t(()=>[(V(),x(Z,null,H(R,r=>l(M,{key:r.value,label:r.label,value:r.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(u,{prop:"agreement"},{default:t(()=>[l(j,{modelValue:a.agreement,"onUpdate:modelValue":e[6]||(e[6]=r=>a.agreement=r)},{default:t(()=>[e[11]||(e[11]=p(" I have read and agree to the ")),l(h,{type:"primary",underline:!1,onClick:z},{default:t(()=>e[9]||(e[9]=[p(" Terms of Service ")])),_:1}),e[12]||(e[12]=p(" and ")),l(h,{type:"primary",underline:!1,onClick:q},{default:t(()=>e[10]||(e[10]=[p(" Privacy Policy ")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(P,{type:"primary",size:"large",class:"submit-btn",loading:c.value,"native-type":"submit"},{default:t(()=>e[13]||(e[13]=[p(" Sign Up ")])),_:1},8,["loading"]),o("div",le,[e[15]||(e[15]=o("span",null,"Already have an account?",-1)),l(N,{to:"/login",class:"login-link"},{default:t(()=>e[14]||(e[14]=[p(" Sign in now ")])),_:1})])]),_:1},8,["model"])]),o("div",oe,[o("div",ae,[e[20]||(e[20]=o("h2",null,"Join Campus Marketplace",-1)),e[21]||(e[21]=o("p",null,"Find the best secondhand items with the safest trading environment",-1)),o("ul",se,[o("li",null,[l(w,null,{default:t(()=>[l(d(k))]),_:1}),e[17]||(e[17]=o("span",null,"Real-name verification for security",-1))]),o("li",null,[l(w,null,{default:t(()=>[l(d(K))]),_:1}),e[18]||(e[18]=o("span",null,"Guaranteed transactions, worry-free payments",-1))]),o("li",null,[l(w,null,{default:t(()=>[l(d(O))]),_:1}),e[19]||(e[19]=o("span",null,"Instant messaging for easy communication",-1))])])])])]),l(b,{modelValue:y.value,"onUpdate:modelValue":e[7]||(e[7]=r=>y.value=r),title:"Terms of Service",width:"600px",class:"agreement-dialog"},{default:t(()=>e[22]||(e[22]=[o("div",{class:"agreement-content"},[o("h3",null,"Welcome to Campus Marketplace"),o("p",null,"This agreement is a legal contract between you and Campus Marketplace...")],-1)])),_:1},8,["modelValue"]),l(b,{modelValue:_.value,"onUpdate:modelValue":e[8]||(e[8]=r=>_.value=r),title:"Privacy Policy",width:"600px",class:"privacy-dialog"},{default:t(()=>e[23]||(e[23]=[o("div",{class:"privacy-content"},[o("h3",null,"Privacy Policy"),o("p",null,"We take your personal information protection very seriously...")],-1)])),_:1},8,["modelValue"])])}}},pe=B(re,[["__scopeId","data-v-701d21f0"]]);export{pe as default};
