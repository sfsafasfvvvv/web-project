import{_ as ae,u as re,K as ie,L as ne,r as c,w as ue,o as de,a as v,b as i,d as u,e as s,t as a,i as o,g as r,k as m,F as h,h as P,q as ce,j as A,f as F,E as _,J as ve,I as me}from"./index-237fd1da.js";const pe={class:"user-center"},fe={class:"container"},_e={class:"user-container"},ye={class:"user-card"},he={class:"user-header"},be={class:"user-avatar",style:{background:"#f5f5f5"}},ge={class:"user-info"},ke={class:"user-stats"},we={class:"stat-item"},Ce={class:"value"},Ve={class:"value"},Pe={class:"value"},Fe={class:"user-actions"},$e={class:"main-content"},Te={key:0,class:"product-grid"},Ue={class:"product-cover",style:{background:"#f5f5f5"}},xe={class:"product-info"},Re={class:"title"},De={class:"price"},Se={class:"meta"},Me={class:"actions"},Ee={key:0,class:"order-list"},Ne={class:"order-product"},qe={class:"product-info"},Be={class:"price"},Ie={class:"order-info"},Le={class:"buyer-info"},Oe={class:"user-avatar small",style:{background:"#f5f5f5"}},Je={class:"username"},Ae={class:"trade-info"},Ge={class:"method"},je={class:"location"},ze={class:"time"},Ke={key:0,class:"order-list"},We={class:"order-product"},He={class:"product-info"},Qe={class:"price"},Xe={class:"order-info"},Ye={class:"seller-info"},Ze={class:"user-avatar small",style:{background:"#f5f5f5"}},et={class:"username"},tt={class:"trade-info"},st={class:"method"},lt={class:"location"},ot={class:"time"},at={class:"order-actions"},rt={key:0,class:"product-grid"},it=["onClick"],nt={class:"product-info"},ut={class:"title"},dt={class:"price"},ct={class:"meta"},vt={__name:"UserCenter",setup(mt){const G=re(),R=ie();ne();const $=c("published"),k=c(!1),w=c(!1),p=c(!1),D=c(null),S=c(null),b=c({rating:5,comment:""}),y=c({username:"",school:"",bio:""}),d=c({id:1,username:"John Doe",school:"Example University",creditScore:100,followCount:10,fansCount:20}),g=c([{id:1,title:"iPhone 12",price:599,status:"active",views:100,createTime:new Date(Date.now()-1e3*60*60*24)},{id:2,title:"MacBook Pro",price:1299,status:"sold",views:200,createTime:new Date(Date.now()-1e3*60*60*24*2)}]),E=c([{id:1,product:{title:"iPhone 12",price:599},buyer:{username:"Jane Smith"},tradeMethod:"Meet on Campus",location:"Library",dealTime:new Date(Date.now()-1e3*60*60*24)}]),N=c([{id:1,product:{title:"MacBook Pro",price:1299},seller:{username:"Tom Wilson"},tradeMethod:"Meet on Campus",location:"Library",dealTime:new Date(Date.now()-1e3*60*60*24),isRated:!1}]),q=c([{id:1,title:"AirPods Pro",price:199,views:150,createTime:new Date(Date.now()-1e3*60*60*24)}]),j=[{value:"pku",label:"Peking University"},{value:"thu",label:"Tsinghua University"},{value:"fudan",label:"Fudan University"}],z={rating:[{required:!0,message:"Please select a rating",trigger:"change"}],comment:[{required:!0,message:"Please enter your review",trigger:"blur"},{min:10,max:200,message:"Length should be 10 to 200 characters",trigger:"blur"}]},K={username:[{required:!0,message:"Please enter username",trigger:"blur"},{min:3,max:20,message:"Length should be 3 to 20 characters",trigger:"blur"}],school:[{required:!0,message:"Please select school",trigger:"change"}]},B=l=>{l?G.push(`/product/${l}/edit`):(y.value={username:d.value.username,school:d.value.school,bio:d.value.bio},w.value=!0)},W=async l=>{try{p.value=!0,await new Promise(n=>setTimeout(n,500)),_.success("Product removed successfully");const e=g.value.find(n=>n.id===l);e&&(e.status="removed")}catch(e){console.error("Failed to remove product:",e),_.error("Failed to remove product")}finally{p.value=!1}},H=async l=>{try{p.value=!0,await new Promise(n=>setTimeout(n,500)),_.success("Product reposted successfully");const e=g.value.find(n=>n.id===l);e&&(e.status="active")}catch(e){console.error("Failed to repost product:",e),_.error("Failed to repost product")}finally{p.value=!1}},Q=async l=>{try{p.value=!0,await new Promise(e=>setTimeout(e,500)),_.success("Product deleted successfully"),g.value=g.value.filter(e=>e.id!==l)}catch(e){console.error("Failed to delete product:",e),_.error("Failed to delete product")}finally{p.value=!1}},X=l=>{b.value={rating:5,comment:""},k.value=!0},Y=async()=>{if(D.value)try{await D.value.validate(),p.value=!0,await new Promise(l=>setTimeout(l,500)),_.success("Rating submitted successfully"),k.value=!1}catch(l){console.error("Failed to submit rating:",l),_.error("Failed to submit rating")}finally{p.value=!1}},Z=async()=>{if(S.value)try{await S.value.validate(),p.value=!0,await new Promise(l=>setTimeout(l,500)),_.success("Profile updated successfully"),w.value=!1,d.value={...d.value,...y.value}}catch(l){console.error("Failed to update profile:",l),_.error("Failed to update profile")}finally{p.value=!1}},T=l=>{if(!l)return"";try{return ve(new Date(l),{addSuffix:!0,locale:me})}catch{return console.error("Invalid time:",l),""}},ee=l=>({active:"Active",sold:"Sold",removed:"Removed"})[l]||l;return ue(()=>R.query.tab,l=>{l&&($.value=l)},{immediate:!0}),de(()=>{R.query.tab&&($.value=R.query.tab)}),(l,e)=>{var O,J;const n=v("el-button"),U=v("el-empty"),x=v("el-tab-pane"),te=v("el-tabs"),se=v("el-rate"),C=v("el-form-item"),M=v("el-input"),I=v("el-form"),L=v("el-dialog"),le=v("el-option"),oe=v("el-select");return i(),u("div",pe,[s("div",fe,[s("div",_e,[s("div",ye,[s("div",he,[s("div",be,a((J=(O=d.value.username)==null?void 0:O[0])==null?void 0:J.toUpperCase()),1),s("div",ge,[s("h2",null,a(d.value.username),1),s("p",null,a(d.value.school),1),s("div",ke,[s("div",we,[s("span",Ce,a(d.value.creditScore),1),e[13]||(e[13]=s("span",{class:"label"},"Credit Score",-1))]),s("div",{class:"stat-item",onClick:e[0]||(e[0]=t=>l.$router.push(`/user/${d.value.id}/following`))},[s("span",Ve,a(d.value.followCount),1),e[14]||(e[14]=s("span",{class:"label"},"Following",-1))]),s("div",{class:"stat-item",onClick:e[1]||(e[1]=t=>l.$router.push(`/user/${d.value.id}/followers`))},[s("span",Pe,a(d.value.fansCount),1),e[15]||(e[15]=s("span",{class:"label"},"Followers",-1))])])]),s("div",Fe,[o(n,{type:"primary",onClick:B},{default:r(()=>e[16]||(e[16]=[m(" Edit Profile ")])),_:1})])])]),s("div",$e,[o(te,{modelValue:$.value,"onUpdate:modelValue":e[3]||(e[3]=t=>$.value=t),class:"user-tabs"},{default:r(()=>[o(x,{label:"My Posts",name:"published"},{default:r(()=>[g.value.length?(i(),u("div",Te,[(i(!0),u(h,null,P(g.value,t=>(i(),u("div",{key:t.id,class:"product-item"},[s("div",Ue,[s("div",{class:ce(["product-status",t.status])},a(ee(t.status)),3)]),s("div",xe,[s("h3",Re,a(t.title),1),s("div",De,"$"+a(t.price),1),s("div",Se,[s("span",null,a(T(t.createTime)),1),s("span",null,a(t.views)+" views",1)]),s("div",Me,[t.status==="active"?(i(),u(h,{key:0},[o(n,{type:"primary",link:"",onClick:f=>B(t.id)},{default:r(()=>e[17]||(e[17]=[m(" Edit ")])),_:2},1032,["onClick"]),o(n,{type:"danger",link:"",onClick:f=>W(t.id)},{default:r(()=>e[18]||(e[18]=[m(" Remove ")])),_:2},1032,["onClick"])],64)):t.status==="removed"?(i(),u(h,{key:1},[o(n,{type:"primary",link:"",onClick:f=>H(t.id)},{default:r(()=>e[19]||(e[19]=[m(" Repost ")])),_:2},1032,["onClick"]),o(n,{type:"danger",link:"",onClick:f=>Q(t.id)},{default:r(()=>e[20]||(e[20]=[m(" Delete ")])),_:2},1032,["onClick"])],64)):A("",!0)])])]))),128))])):(i(),F(U,{key:1,description:"No items posted yet"},{default:r(()=>[o(n,{type:"primary",onClick:e[2]||(e[2]=t=>l.$router.push("/publish"))},{default:r(()=>e[21]||(e[21]=[m(" Post Item ")])),_:1})]),_:1}))]),_:1}),o(x,{label:"Sold Items",name:"sold"},{default:r(()=>[E.value.length?(i(),u("div",Ee,[(i(!0),u(h,null,P(E.value,t=>{var f,V;return i(),u("div",{key:t.id,class:"order-item"},[s("div",Ne,[e[22]||(e[22]=s("div",{class:"product-cover",style:{background:"#f5f5f5"}},null,-1)),s("div",qe,[s("h3",null,a(t.product.title),1),s("div",Be,"$"+a(t.product.price),1)])]),s("div",Ie,[s("div",Le,[s("div",Oe,a((V=(f=t.buyer.username)==null?void 0:f[0])==null?void 0:V.toUpperCase()),1),s("span",Je,a(t.buyer.username),1)]),s("div",Ae,[s("div",Ge,a(t.tradeMethod),1),s("div",je,a(t.location),1),s("div",ze,a(T(t.dealTime)),1)])])])}),128))])):(i(),F(U,{key:1,description:"No items sold yet"}))]),_:1}),o(x,{label:"Purchased Items",name:"bought"},{default:r(()=>[N.value.length?(i(),u("div",Ke,[(i(!0),u(h,null,P(N.value,t=>{var f,V;return i(),u("div",{key:t.id,class:"order-item"},[s("div",We,[e[23]||(e[23]=s("div",{class:"product-cover",style:{background:"#f5f5f5"}},null,-1)),s("div",He,[s("h3",null,a(t.product.title),1),s("div",Qe,"$"+a(t.product.price),1)])]),s("div",Xe,[s("div",Ye,[s("div",Ze,a((V=(f=t.seller.username)==null?void 0:f[0])==null?void 0:V.toUpperCase()),1),s("span",et,a(t.seller.username),1)]),s("div",tt,[s("div",st,a(t.tradeMethod),1),s("div",lt,a(t.location),1),s("div",ot,a(T(t.dealTime)),1)]),s("div",at,[t.isRated?A("",!0):(i(),F(n,{key:0,type:"primary",link:"",onClick:pt=>X(t)},{default:r(()=>e[24]||(e[24]=[m(" Rate ")])),_:2},1032,["onClick"]))])])])}),128))])):(i(),F(U,{key:1,description:"No items purchased yet"}))]),_:1}),o(x,{label:"Favorites",name:"favorite"},{default:r(()=>[q.value.length?(i(),u("div",rt,[(i(!0),u(h,null,P(q.value,t=>(i(),u("div",{key:t.id,class:"product-item",onClick:f=>l.$router.push(`/product/${t.id}`)},[e[25]||(e[25]=s("div",{class:"product-cover",style:{background:"#f5f5f5"}},null,-1)),s("div",nt,[s("h3",ut,a(t.title),1),s("div",dt,"$"+a(t.price),1),s("div",ct,[s("span",null,a(T(t.createTime)),1),s("span",null,a(t.views)+" views",1)])])],8,it))),128))])):(i(),F(U,{key:1,description:"No favorite items yet"}))]),_:1})]),_:1},8,["modelValue"])])])]),o(L,{modelValue:k.value,"onUpdate:modelValue":e[7]||(e[7]=t=>k.value=t),title:"Rate Item",width:"500px"},{footer:r(()=>[o(n,{onClick:e[6]||(e[6]=t=>k.value=!1)},{default:r(()=>e[26]||(e[26]=[m("Cancel")])),_:1}),o(n,{type:"primary",onClick:Y},{default:r(()=>e[27]||(e[27]=[m("Submit")])),_:1})]),default:r(()=>[o(I,{ref_key:"rateFormRef",ref:D,model:b.value,rules:z,"label-width":"80px"},{default:r(()=>[o(C,{label:"Rating",prop:"rating"},{default:r(()=>[o(se,{modelValue:b.value.rating,"onUpdate:modelValue":e[4]||(e[4]=t=>b.value.rating=t),max:5,texts:["Poor","Fair","Good","Very Good","Excellent"],"show-text":""},null,8,["modelValue"])]),_:1}),o(C,{label:"Comment",prop:"comment"},{default:r(()=>[o(M,{modelValue:b.value.comment,"onUpdate:modelValue":e[5]||(e[5]=t=>b.value.comment=t),type:"textarea",rows:4,placeholder:"Please enter your review (10-200 characters)",maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),o(L,{modelValue:w.value,"onUpdate:modelValue":e[12]||(e[12]=t=>w.value=t),title:"Edit Profile",width:"500px"},{footer:r(()=>[o(n,{onClick:e[11]||(e[11]=t=>w.value=!1)},{default:r(()=>e[28]||(e[28]=[m("Cancel")])),_:1}),o(n,{type:"primary",onClick:Z},{default:r(()=>e[29]||(e[29]=[m("Save")])),_:1})]),default:r(()=>[o(I,{ref_key:"editFormRef",ref:S,model:y.value,rules:K,"label-width":"100px"},{default:r(()=>[o(C,{label:"Username",prop:"username"},{default:r(()=>[o(M,{modelValue:y.value.username,"onUpdate:modelValue":e[8]||(e[8]=t=>y.value.username=t),placeholder:"Enter username"},null,8,["modelValue"])]),_:1}),o(C,{label:"School",prop:"school"},{default:r(()=>[o(oe,{modelValue:y.value.school,"onUpdate:modelValue":e[9]||(e[9]=t=>y.value.school=t),placeholder:"Select school",filterable:""},{default:r(()=>[(i(),u(h,null,P(j,t=>o(le,{key:t.value,label:t.label,value:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),o(C,{label:"Bio",prop:"bio"},{default:r(()=>[o(M,{modelValue:y.value.bio,"onUpdate:modelValue":e[10]||(e[10]=t=>y.value.bio=t),type:"textarea",rows:4,placeholder:"Tell us about yourself",maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},_t=ae(vt,[["__scopeId","data-v-e72f6f94"]]);export{_t as default};
